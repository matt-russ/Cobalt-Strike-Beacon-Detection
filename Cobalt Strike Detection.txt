Detects when Cobalt Strike's 32 bit payload "Beacon" is injected into the most common 64 bit processes.  When using Cobalt Strike, the default option is to use the 32 bit payload. Using the 32 bit payload creates some interesting detection opportunities. When Beacon is running on a target computer, it is common for the operator (the person using Cobalt Strike) to inject the payload into another process that blends in more. When the 32 bit payload is being injected into 64 bit processes (64 bit processes are usually the ones running), the only way Beacon can access/interact with the 64 bit processes is through the C:\Windows\sysnative\ directory. Therefore, when the operator issues the spawn to command to inject Beacon into a process that blends in more, it will have the command line of only the full path of the process they are injecting into (C:\Windows\sysnative\<whatever process they are injecting into>) which rarely occurs.

(process.command_line is 'C:\\windows\\sysnative\\dllhost.exe' OR
process.command_line is 'C:\\windows\\sysnative\\rundll32.exe' OR
process.command_line is 'C:\\windows\\sysnative\\svchost.exe' OR
process.command_line is 'C:\\windows\\sysnative\\werfault.exe' OR
process.command_line is 'C:\\windows\\sysnative\\searchprotocolhost.exe' OR
process.command_line is 'C:\\windows\\sysnative\\regsvr32.exe' OR
process.command_line is 'C:\\windows\\sysnative\\gpupdate.exe' OR
process.command_line is 'C:\\windows\\sysnative\\msiexec.exe' OR
process.command_line is 'C:\\windows\\sysnative\\eventvwr.exe' OR
process.command_line is 'C:\\windows\\sysnative\\taskeng.exe' OR
process.command_line is 'C:\\windows\\sysnative\\spoolsv.exe' OR
process.command_line is 'C:\\windows\\sysnative\\runonce.exe' OR
process.command_line is 'C:\\windows\\sysnative\\WUAUCLT.exe' OR
process.command_line is 'C:\\windows\\sysnative\\conhost.exe' OR
process.command_line is 'C:\\windows\\sysnative\\control.exe' OR
process.command_line is 'C:\\windows\\sysnative\\help.exe' OR
process.command_line is 'C:\\windows\\sysnative\\LogonUI.exe' OR
process.command_line is 'C:\\windows\\sysnative\\print.exe' OR
process.command_line is 'C:\\windows\\sysnative\\audiodg.exe' OR
process.command_line is 'C:\\windows\\sysnative\\msinfo32.exe' OR
process.command_line is 'C:\\windows\\sysnative\\RuntimeBroker.exe' OR
process.command_line is 'C:\\windows\\sysnative\\WindowsPowerShell\\v1.0\\powershell.exe')


Detects when Cobalt Strike's 32 bit payload "Beacon" is injected into the most common 32 bit processes.  When using Cobalt Strike, the default option is to use the 32 bit payload. Typically, Beacon is injected into 64 bit processes, but there is an option to inject it into 32 bit processes. When Beacon is injected into another process with the spawn to command, it will start a process with the command line arguments of the process it is injecting into, which rarely happens.

(process.command_line is 'C:\\windows\\syswow64\\dllhost.exe' OR
process.command_line is 'C:\\windows\\syswow64\\rundll32.exe' OR
process.command_line is 'C:\\windows\\syswow64\\svchost.exe' OR
process.command_line is 'C:\\windows\\syswow64\\werfault.exe' OR
process.command_line is 'C:\\windows\\syswow64\\searchprotocolhost.exe' OR
process.command_line is 'C:\\windows\\syswow64\\regsvr32.exe' OR
process.command_line is 'C:\\windows\\syswow64\\gpupdate.exe' OR
process.command_line is 'C:\\windows\\syswow64\\msiexec.exe' OR
process.command_line is 'C:\\windows\\syswow64\\eventvwr.exe' OR
process.command_line is 'C:\\windows\\syswow64\\taskeng.exe' OR
process.command_line is 'C:\\windows\\syswow64\\spoolsv.exe' OR
process.command_line is 'C:\\windows\\syswow64\\runonce.exe' OR
process.command_line is 'C:\\windows\\syswow64\\WUAUCLT.exe' OR
process.command_line is 'C:\\windows\\syswow64\\conhost.exe' OR
process.command_line is 'C:\\windows\\syswow64\\control.exe' OR
process.command_line is 'C:\\windows\\syswow64\\help.exe' OR
process.command_line is 'C:\\windows\\syswow64\\LogonUI.exe' OR
process.command_line is 'C:\\windows\\syswow64\\print.exe' OR
process.command_line is 'C:\\windows\\syswow64\\audiodg.exe' OR
process.command_line is 'C:\\windows\\syswow64\\msinfo32.exe' OR
process.command_line is 'C:\\windows\\syswow64\\RuntimeBroker.exe' OR
process.command_line is 'C:\\windows\\syswow64\\explorer.exe' OR
process.command_line is 'C:\\windows\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe')